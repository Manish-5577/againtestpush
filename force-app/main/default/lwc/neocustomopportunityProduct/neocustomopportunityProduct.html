<template>
  
  <div lwc:if={errormssg}   class="slds-notify slds-notify_alert slds-alert_error" role="alert">
    <span class="slds-assistive-text">error</span>
    <span class="slds-icon_container slds-icon-utility-error slds-m-right_x-small" title="Description of icon when needed">
    <svg class="slds-icon slds-icon_x-small" aria-hidden="true">
    <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#error"></use> -->
    </svg>
    </span>
    <h2> {errormssg}
    abc
    </h2>
    <div class="slds-notify__close">
    <button class="slds-button slds-button_icon slds-button_icon-small slds-button_icon-inverse" title="Close">
    <svg class="slds-button__icon" aria-hidden="true">
    <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use> -->
    </svg>
    <span class="slds-assistive-text">Close</span>
    </button>
    </div>
    </div>
    <template lwc:if={showmodal}>
     <c-add-pricebook  onmodaloff ={modallof}  onmodaloff22 ={modalloff} parentobject-api-name={objectApiName} parent-id ={recordId}  onrecivepriced={handlerecivepriceid}></c-add-pricebook>
  </template>
  <template lwc:if={showpricebook}>
    <p>Hello Manuuuu, Please associate this oportunity with Price book</p>
    <p><lightning-button 
      variant="brand"
      label="AssociatePricebook" 
      onclick={handleClick} 
    ></lightning-button></p>
 </template>
  <template lwc:else>
    <lightning-button 
    variant="brand"
    label="Add more" 
    onclick={addrow} 
    slot="actions"
    
  ></lightning-button>
  &nbsp;&nbsp;&nbsp;
  <lightning-button 
    variant="brand"
    label="Update new record" 
    onclick={handleproductupdate} 
    slot="actions"
    
  ></lightning-button>
  
  <table aria-multiselectable="true" class="slds-table slds-table_bordered slds-table_fixed-layout slds-table_resizable-cols" role="grid" aria-label="Example advanced table of Opportunities in actionable mode">
      <thead>
      <tr class="slds-line-height_reset">
      <!-- <th class="slds-text-align_right slds-cell_action-mode" scope="col" style="width:3.25rem">
      <span id="column-group-header" class="slds-assistive-text">Choose a row</span>
      <div class="slds-th__action slds-th__action_form">
      <div class="slds-checkbox">
      <input type="checkbox" name="options" id="checkbox-unique-id-293" value="checkbox-unique-id-293" tabindex="0" aria-labelledby="check-select-all-label column-group-header" />
      <label class="slds-checkbox__label" for="checkbox-unique-id-293" id="check-select-all-label">
      <span class="slds-checkbox_faux"></span>
      <span class="slds-form-element__label slds-assistive-text">Select All</span>
      </label>
      </div>
      </div>
      </th> -->
      <th aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col">
      <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
      <span class="slds-assistive-text">Sort by: </span>
      <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
      <span class="slds-truncate" title="Name">Product</span>
      <span class="slds-icon_container slds-icon-utility-arrowdown">
      <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
      <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use> -->
      </svg>
      </span>
      </div>
      </a>
      <div class="slds-resizable">
      <input type="range" aria-label="Name column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-533" max="1000" min="20" tabindex="0" />
      <span class="slds-resizable__handle">
      <span class="slds-resizable__divider"></span>
      </span>
      </div>
      </th>
      <th aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col">
      <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
      <span class="slds-assistive-text">Sort by: </span>
      <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
      <span class="slds-truncate" title="Account Name">Quantity</span>
      <span class="slds-icon_container slds-icon-utility-arrowdown">
      <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
      <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use> -->
      </svg>
      </span>
      </div>
      </a>
      <div class="slds-resizable">
      <input type="range" aria-label="Account Name column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-534" max="1000" min="20" tabindex="0" />
      <span class="slds-resizable__handle">
      <span class="slds-resizable__divider"></span>
      </span>
      </div>
      </th>
      <th aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col">
      <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
      <span class="slds-assistive-text">Sort by: </span>
      <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
      <span class="slds-truncate" title="Close Date">Sales Price</span>
      <span class="slds-icon_container slds-icon-utility-arrowdown">
      <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
      <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use> -->
      </svg>
      </span>
      </div>
      </a>
      <div class="slds-resizable">
      <input type="range" aria-label="Close Date column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-535" max="1000" min="20" tabindex="0" />
      <span class="slds-resizable__handle">
      <span class="slds-resizable__divider"></span>
      </span>
      </div>
      </th>
      <th aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col">
      <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
      <span class="slds-assistive-text">Sort by: </span>
      <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
      <span class="slds-truncate" title="Stage">Date</span>
      <span class="slds-icon_container slds-icon-utility-arrowdown">
      <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
      <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use> -->
      </svg>
      </span>
      </div>
      </a>
      <div class="slds-resizable">
      <input type="range" aria-label="Stage column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-536" max="1000" min="20" tabindex="0" />
      <span class="slds-resizable__handle">
      <span class="slds-resizable__divider"></span>
      </span>
      </div>
      </th>
      <th aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col">
          <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
          <span class="slds-assistive-text">Sort by: </span>
          <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
          <span class="slds-truncate" title="Stage">Description</span>
          <span class="slds-icon_container slds-icon-utility-arrowdown">
          <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
          <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use> -->
          </svg>
          </span>
          </div>
          </a>
          <div class="slds-resizable">
          <input type="range" aria-label="Stage column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-537" max="1000" min="20" tabindex="0" />
          <span class="slds-resizable__handle">
          <span class="slds-resizable__divider"></span>
          </span>
          </div>
          </th>
          <th aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col">
              <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
              <span class="slds-assistive-text">Sort by: </span>
              <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
              <span class="slds-truncate" title="Stage">Delete</span>
              <span class="slds-icon_container slds-icon-utility-arrowdown">
              <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
              <!-- <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use> -->
              </svg>
              </span>
              </div>
              </a>
              <div class="slds-resizable">
              <input type="range" aria-label="Stage column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-538" max="1000" min="20" tabindex="0" />
              <span class="slds-resizable__handle">
              <span class="slds-resizable__divider"></span>
              </span>
              </div>
              </th>
      
     
      <th class="slds-cell_action-mode" scope="col" style="width:3.25rem">
      <div class="slds-truncate slds-assistive-text" title="Actions">Actions</div>
      </th>
      </tr>
      </thead>
      <tbody>
          <template for:each={record} for:item="rec" for:index ="index" if:true={record}>
      {index}
      <tr  key={rec.Id} aria-selected="false" class="slds-hint-parent">
      <!-- <td class="slds-text-align_right slds-cell_action-mode" role="gridcell">
      <div class="slds-checkbox">
      <input type="checkbox" name="options" id="checkbox-01" value="checkbox-01" tabindex="0" aria-labelledby="check-button-label-01 column-group-header" />
      <label class="slds-checkbox__label" for="checkbox-01" id="check-button-label-01">
      <span class="slds-checkbox_faux"></span>
      <span class="slds-form-element__label slds-assistive-text">Select item 1</span>
      </label>
      </div>
      </td> -->
      <td class="slds-cell_action-mode" scope="row">
     
      <!-- <a href="#" tabindex="0">Acme - 1,200 Widgets</a> -->
    <lightning-input 
      type="search"
      label="Enter some text"
      onchange={handlemodalchange}
      value={rec.lookuptext}
      if:false={rec.Id}
      data-index={index}
    ></lightning-input>
    <span if:true={rec.lookuptext} class="search_effect" data-index={index} data-value ={rec.lookuptext} onclick ={openmodalextendedone} >
<P if:false={rec.Id} class="test">
      <lightning-icon 
        icon-name="utility:search" 
        size="xx-small" 
      ></lightning-icon>
      show all result{rec.lookuptext}
    </P>
    </span>
      <!-- <c-amitcustomlookup iconname="standard:contact" 
      object-name="Product2"
      searchfield={fields}
      onchange={handlechangee}
      index ={index}
      data-index ={index}
      name ='Product2Id'
      value ={rec.Product2Id}
      if:false ={rec.Id}
      onselectedrec = {handleslectedrecord}
      displayfield="ProductCode"></c-amitcustomlookup> -->
  <div if:true ={rec.Id}>
            <a href="Javascript:void{0}" onclick={navigatetodetailpage} data-record-id={rec.Id}>
              {rec.Product2.Name}
              </a>
  </div>
     
      </td>
      <td class="slds-cell_action-mode" role="gridcell">
      <lightning-input 
        type="number"
        label="Quantity"
        value ={rec.Quantity}
        onchange={handlechangee}
        name ="Quantity"
        data-index ={index}
        required =true
        variant = "label-hidden"
      ></lightning-input>
      </td>
      <td class="slds-cell_action-mode" role="gridcell">
      <lightning-input 
        type="number"
        label="Sales Price"
        name ="UnitPrice"
        index ={index}
        onchange={handlechangee}
        value ={rec.UnitPrice}
        required =true
        data-index ={index}
        formatter = "currency"
        variant = "label-hidden"
        step ="0.01"
      ></lightning-input>
      </td>
      <td class="slds-cell_action-mode" role="gridcell">
     <lightning-input 
       type="date"
       label="Date"
        required =true
       data-index ={index}
       name="ServiceDate"
       onchange={handlechangee}
       value ={rec.ServiceDate}
       variant = "label-hidden"
     ></lightning-input>
      </td>
      <td class="slds-cell_action-mode" role="gridcell">
          <lightning-textarea 
            name="Description"
            label ="Description"
            onchange={handlechangee}
            data-index ={index}
            value ={rec.Description}
            variant = "label-hidden"
          ></lightning-textarea>
           </td>
           <td class="slds-cell_action-mode" role="gridcell">
            <lightning-icon 
              icon-name="utility:delete" 
              class="icon-delete"
              size="xx-small" 
              data-index ={index}
              data-record-id ={rec.Id}
                if:true={index}
                onclick={handleremove}
            ></lightning-icon>
           </td>
      
      </tr>
  </template> 
     
      </tbody>
      </table>
  </template>
  
     
  </template>